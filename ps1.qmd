---
title: "ps1"
author: "Megan Martinez" 
format: pdf
tables: TRUE 
---

"Initial Project Setup"

GitHub Repository: <https://github.com/meganmartinez-25/Gov51-ps1.git>

#Part 2

1.

```{r}
#Loading tidyverse and reading in my ACS data
library(tidyverse)
acs2024_raw <- read.csv("gov51-ps1/data/raw/acs2024.csv")

```

2.  Variables: STATEFIP = State (FIPS code), SEX= (Sex), AGE = (Age), EDUC = Education attainment (general version), EMPSTAT = Employement status (general version), INCTOT = Total Personal Income, TRANTIME = Travel Time to Work. For TRANTIME, 000 signifies N/A. THE PERWT is attempting to describe how many people in the population are represented by each "sample case."

3. Create New Variables  

```{r}
acs2024 <-acs2024_raw %>% 
  select("STATEFIP", "SEX", "AGE", "EDUC", "EMPSTAT","INCTOT","TRANTIME", "PERWT") %>% 
  mutate(female = if_else(SEX == 2, 1, 0), 
  less_than_hs = if_else(EDUC %in% c(0,1,2), 1, 0),
  hs_only = if_else(EDUC %in% c(3,4,5,6), 1, 0), 
  some_college = if_else(EDUC %in% c(7,8,9), 1, 0), 
  college_only = if_else(EDUC == 10,1,0),
  advanced_degree = if_else(EDUC == 11, 1, 0)) |> 
  
  mutate(employed = if_else(EMPSTAT == 1, 1, 0, 
              if_else(EMPSTAT %in% c(0,9), NA_integer_, 0)),
  unemployed = if_else(EMPSTAT == 2, 1, 0, 
                if_else(EMPSTAT %in% c(0,9), NA_integer_, 0)), 
  not_in_labor_force = if_else(EMPSTAT == 3, 1, 0, 
   if_else(EMPSTAT %in% c(0,9), NA_integer_, 0))) |>
  mutate(INCTOT = if_else(INCTOT >= c(9999999, 9999998), NA_real_, INCTOT))

#question about the NA_character
#do i need to mutate TRANTIME on this one yet? 


```

4.  If you treated N/A codes as real zeroes when calculating summary statistics, this would skew the data to the left, because for a variable that is not supposed to have any 0 values, if there is even one, with a range from 0 to 888, having zeroes part of the final calculation will cause the mean, or average, to lower which will depict a smaller average commute time in minutes than if the 0s were not included. On the other hand, if N/A was represented by a very large number, for example, for INCTOT, 9999999 signifies N/A, and you included the data points that were N/A in your final analysis, when calculating summary statistics, the mean would be greatly skewed to the right. This large value would be pulling the INCTOT mean much higher than it ought to be for it to accurately represent the total income of the sample. 

```{r}

library(knitr)

acs2024_rename <- acs2024 %>% 
  rename( "Age" = "AGE", 
     "Female" = "female" , 
     "Less than High School"= "less_than_hs" , 
     "High School Only"= "hs_only",
     "Some College" = "some_college" , 
     "College Only"= "college_only" , 
    "Advanced Degree" = "advanced_degree" , 
   "Employed" =  "employed" , 
     "Unemployed" = "unemployed" , 
     "Not in Labor Force" = "not_in_labor_force", 
     "Commute Time (mins)" = "TRANTIME", 
    "Total Income ($)" = "INCTOT", 
   "PERWT"= "PERWT")

acs2024_stats <- data.frame(
  Variable = c("Age", "Female", "Less than High School", "High School Only",  "Some College", "College Only", "Advanced Degree", "Employed", "Unemployed", "Not in Labor Force", "Commute Time (mins)", "Total Income ($)"),
  N = c(sum(!is.na(acs2024_rename$`Age`)),
        sum(!is.na(acs2024_rename$`Female`)),
        sum(!is.na(acs2024_rename$`Less than High School`)),
        sum(!is.na(acs2024_rename$`High School Only`)),
        sum(!is.na(acs2024_rename$`Some College`)),
        sum(!is.na(acs2024_rename$`College Only`)),
        sum(!is.na(acs2024_rename$`Advanced Degree`)),
        sum(!is.na(acs2024_rename$`Employed`)),
        sum(!is.na(acs2024_rename$`Unemployed`)),
        sum(!is.na(acs2024_rename$`Not in Labor Force`)),
        sum(!is.na(acs2024_rename$`Commute Time (mins)`)),
        sum(!is.na(acs2024_rename$`Total Income ($)`))),
  Mean = c(mean(acs2024_rename$`Age`),
           mean(acs2024_rename$`Female`), 
           mean(acs2024_rename$`Less than High School`),
           mean(acs2024_rename$`High School Only`), 
           mean(acs2024_rename$`Some College`),
           mean(acs2024_rename$`College Only`),
           mean(acs2024_rename$`Advanced Degree`), 
           mean(acs2024_rename$`Employed`),
           mean(acs2024_rename$`Unemployed`), 
           mean(acs2024_rename$`Not in Labor Force`),
           mean(acs2024_rename$`Commute Time (mins)`),
           mean(acs2024_rename$`Total Income ($)`, na.rm = TRUE)),
  SD = c(sd(acs2024_rename$`Age`),
         sd(acs2024_rename$`Female`), 
         sd(acs2024_rename$`Less than High School`),
         sd(acs2024_rename$`High School Only`), 
         sd(acs2024_rename$`Some College`),
         sd(acs2024_rename$`College Only`), 
         sd(acs2024_rename$`Advanced Degree`),
         sd(acs2024_rename$`Employed`), 
         sd(acs2024_rename$`Unemployed`),
         sd(acs2024_rename$`Not in Labor Force`), 
         sd(acs2024_rename$`Commute Time (mins)`),
         sd(acs2024_rename$`Total Income ($)`, na.rm=TRUE)),
  Min = c(min(acs2024_rename$`Age`),
          min(acs2024_rename$`Female`), 
          min(acs2024_rename$`Less than High School`),
          min(acs2024_rename$`High School Only`), 
          min(acs2024_rename$`Some College`),
          min(acs2024_rename$`College Only`), 
          min(acs2024_rename$`Advanced Degree`),
          min(acs2024_rename$`Employed`), 
          min(acs2024_rename$`Unemployed`),
          min(acs2024_rename$`Not in Labor Force`), 
          min(acs2024_rename$`Commute Time (mins)`),
          min(acs2024_rename$`Total Income ($)`, na.rm = TRUE)),
  Max = c(max(acs2024_rename$`Age`),
          max(acs2024_rename$`Female`), 
          max(acs2024_rename$`Less than High School`),
          max(acs2024_rename$`High School Only`), 
          max(acs2024_rename$`Some College`),
          max(acs2024_rename$`College Only`), 
          max(acs2024_rename$`Advanced Degree`),
          max(acs2024_rename$`Employed`), 
          max(acs2024_rename$`Unemployed`),
          max(acs2024_rename$`Not in Labor Force`), 
          max(acs2024_rename$`Commute Time (mins)`),
          max(acs2024_rename$`Total Income ($)`, na.rm = TRUE))) %>% 
  knitr::kable(caption = "Summary Statistics for 2024 ACS Sample",
               format = "latex", 
               booktabs = TRUE,
               digits = 2)
               
acs2024_stats



```



6.Does the maximum commute time make sense for a daily commute? 
Yes, this makes sense because if the maximum is 195 minutes, this is approximately 3.25 hours spent on a commute, which can become tiresome, but if it is mandatory and one often gets caught in traffic, this can become a reality for many people. However, from California, this can be a reality for many, yet, it would become very tiresome and unfair to expect someone to commute for 6.5 hours daily to work. Therefore, depending on whether someone is comfortable or needs to commute that long to get to work, this commute time can be a reality, but it does not make sense or sound feasible.  


#Analysis Section 

```{r, include=FALSE}

acs2024$TRANTIME

sum(acs2024_raw$TRANTIME == 0, na.rm = TRUE)
length(acs2024_raw$TRANTIME)

#acs2024_raw$TRANTIME
```

1.  2062945 people have 0 minute commute time, there are a total number of 3422888 people. 60.27% of total commuters do not have a commuter time at all.

2.  People who would not have a commuter time would be children, retirees/elderly, unemployed people, remote workers, and people who carpool to their work.

```{r}
commuters <- acs2024_rename %>% 
  filter(`Commute Time (mins)` != 0)
#acs2024_commuters<- acs2024 %>% 
#    mutate(commuters = if_else(TRANTIME %in% c(0, 888), NA_real_, TRANTIME))

#commuters$`Commute Time (mins)`


#commuters variable 
```

3. My criteria for the commuters variable was anyone with a commuter time greater than 0 and not inclusive of 888. This is because 000 signifies "N/A" and 888 is coded to "Suppress for data year 2023 for select PUMAs." Therefore, my eliminating these from being included in the commuters variable and reclassifying as N/A these values are unable to impact the data and the summary of the variable. Also, I am considering anyone with a commute time greater than 0 to be a commuter because there is still time being taken to travel from work to home, and therefore, no matter how small this may be (even if it is only one minute) it is still a commute from one place to another and therefore, I considered in my data.  

```{r}
#sum data where it is not 0 or 888
sum(commuters$`Commute Time (mins)` !=0 & commuters$`Commute Time (mins)` !=888, na.rm = TRUE)


```

3. There are 1359943 commuters left, which matches the remaining numbers that do not equal 0 or 888, after you subtract 3,422,888-2,062,945 (subtracting the total number of individuals - those who do not have a commute time).

```{r}
summary(commuters$`Commute Time (mins`)
```

3b. The minimum is 1.00 minute. This does not seem very feasible, but if someone were to live next to where they work, this could be a plausible explanation for having a 1 minute commute time. Someone also may live in the same building as where they work and they would only have to commute to their apartment which could be a short distance. 

```{r}
library(knitr)

acs2024_rename <- acs2024 %>% 
  rename( "Age" = "AGE", 
     "Female" = "female" , 
     "Less than High School"= "less_than_hs" , 
     "High School Only"= "hs_only",
     "Some College" = "some_college" , 
     "College Only"= "college_only" , 
    "Advanced Degree" = "advanced_degree" , 
   "Employed" =  "employed" , 
     "Unemployed" = "unemployed" , 
     "Not in Labor Force" = "not_in_labor_force", 
     "Commute Time (mins)" = "TRANTIME", 
    "Total Income ($)" = "INCTOT", 
   "PERWT" = "PERWT")

acs2024_commuter <- data.frame(
  Variable = c("Age", "Female", "Less than High School", "High School Only",  "Some College", "College Only", "Advanced Degree", "Employed", "Unemployed", "Not in Labor Force", "Commute Time (mins)", "Total Income ($)"),
  N = c(length(commuters$`Age`),
        length(commuters$`Female`),
        length(commuters$`Less than High School`),
        length(commuters$`High School Only`),
        length(commuters$`Some College`),
        length(commuters$`College Only`),
        length(commuters$`Advanced Degree`),
        length(commuters$`Employed`),
        length(commuters$`Unemployed`),
        length(commuters$`Not in Labor Force`),
        length(commuters$`Commute Time (mins)`),
        length(commuters$`Total Income ($)`)),
  Mean = c(mean(commuters$`Age`),
           mean(commuters$`Female`), 
           mean(commuters$`Less than High School`),
           mean(commuters$`High School Only`), 
           mean(commuters$`Some College`),
           mean(commuters$`College Only`),
           mean(commuters$`Advanced Degree`), 
           mean(commuters$`Employed`),
           mean(commuters$`Unemployed`), 
           mean(commuters$`Not in Labor Force`),
           mean(commuters$`Commute Time (mins)`),
           mean(commuters$`Total Income ($)`, na.rm = TRUE)),
  SD = c(sd(commuters$`Age`),
         sd(commuters$`Female`), 
         sd(commuters$`Less than High School`),
         sd(commuters$`High School Only`), 
         sd(commuters$`Some College`),
         sd(commuters$`College Only`), 
         sd(commuters$`Advanced Degree`),
         sd(commuters$`Employed`), 
         sd(commuters$`Unemployed`),
         sd(commuters$`Not in Labor Force`), 
         sd(commuters$`Commute Time (mins)`),
         sd(commuters$`Total Income ($)`, na.rm=TRUE)),
  Min = c(min(commuters$`Age`),
          min(commuters$`Female`), 
          min(commuters$`Less than High School`),
          min(commuters$`High School Only`), 
          min(commuters$`Some College`),
          min(commuters$`College Only`), 
          min(commuters$`Advanced Degree`),
          min(commuters$`Employed`), 
          min(commuters$`Unemployed`),
          min(commuters$`Not in Labor Force`), 
          min(commuters$`Commute Time (mins)`),
          min(commuters$`Total Income ($)`, na.rm = TRUE)),
  Max = c(max(commuters$`Age`),
          max(commuters$`Female`), 
          max(commuters$`Less than High School`),
          max(commuters$`High School Only`), 
          max(commuters$`Some College`),
          max(commuters$`College Only`), 
          max(commuters$`Advanced Degree`),
          max(commuters$`Employed`), 
          max(commuters$`Unemployed`),
          max(commuters$`Not in Labor Force`), 
          max(commuters$`Commute Time (mins)`),
          max(commuters$`Total Income ($)`, na.rm = TRUE))) %>% 
  knitr::kable(caption = "Summary Statistics for 2024 ACS Sample",
               format = "latex", 
               booktabs = TRUE,
               digits = 2)
               
acs2024_commuter
               
```



#Commuters Subset Created 

Part 4: 

```{r}
acs_hist <- ggplot(commuters, aes(x = `Commute Time (mins)`)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
  labs(x = "Commute Time (mins)",
       y = "Number of Individuals 
       who have a Commute",
       title = "Distribution of Commute Times for Individuals
       (in minutes)", 
       caption = "Green Line: Median (20 min), 
       Red Line: Mean(27.22 min)") +
  geom_vline(xintercept = mean(commuters$`Commute Time (mins)`),
             color = "red", linetype = "dashed", linewidth = 1) +
  geom_vline(xintercept = median(commuters$`Commute Time (mins)`),
             color = "darkgreen", linetype = "dashed", linewidth = 1) 

acs_hist

```



```{r}
median(commuters$`Commute Time (mins)`)
```
The median is 20 minutes. 

2. The histogram for individuals who have a commute time is skewed to the right, with a long tail. There also appears to be a cluster of individuals around the 125-150 minutes, that could be considered outliers from the data set, while the rest of the data is centered around individuals with a commuting time from 0 to 50 minutes. The median of the data is 20 minutes, but the highest peaks of the data are around  10-20 minutes, with a dip at 25 minutes, and a peak again at a 30 minute commute. 

3. The mean commute time of (27.22 mins) is greater than the median commute time of 20 minutes, which is understandable because the cluster of commuters whose travel takes 140-155 minutes pulls the mean to the right. These larger values are outliers of individuals whose commute times take longer than the majority of commuters, and therefore, when computing the mean, these points influence the calculation, raising the mean higher than the median. This also shares insight into how the data is skewed to the right because if our mean is larger than our median, then we have more data points that are greater than the majority cluster influencing our data, which is seen in our histogram that is skewed to the right. 

```{r}

getwd()
list.files()
ggsave("gov51-ps1/output/commute_histogram.png", 
       plot= acs_hist, 
       device = NULL, 
       path = NULL, 
       scale = 1, 
       width = NA, 
       height= NA,
       dpi= 300, 
       limitsize = TRUE, 
       bg = NULL)
```

'Histogram push and save" 
?ggsave


```{r}
names(acs2024_raw)
names(acs2024)
names(acs2024_rename)
names(commuters)
length(commuters$`Commute Time (mins)`)
length(commuters$PERWT)



weighted.mean(commuters$`Commute Time (mins)`, commuters$PERWT, na.rm= TRUE)
```

1. The weighted mean is 27.19112 or ~27.19 mins. The unweighted mean for commuters is 27.22 mins. These two means are different by .03 mins. 
3. The weighted mean is taking the average of observations that are "weighted" by a certain characteristic that better reflects the population.  For this example, PEWRT was  how much each person represented a certain number of people in the United States, so the weighted average was attempting to look at the mean for the population as a whole. The mean is simply the mean of the sample with each individual being counted equally, and the two were slightly different because people who represented more people in the United States may have had a lower commute time, and therefore, they reflected the slightly lower weighted mean to the mean. Nevertheless, because they were so similar to one another, this could indicate that the commute time is uncorrelated to the weights, so the mean of the average commute time would be approximately the same, but because there is a slight difference likely there was a slightly larger weight for those with a smaller commute time. 
